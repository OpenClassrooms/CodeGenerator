<?php
{% include "Header.php.twig" %}

namespace {{ controllerNamespace }};

use {{ showViewModelClassName }};
use {{ exceptionClassName }};
use {{ useCaseResponseClassName }};
use Symfony\Bundle\FrameworkBundle\Controller\Controller;
use Symfony\Component\HttpFoundation\Response;

/**
 * @author {{ author }} <{{ authorEmail }}>
 */
class {{ controllerShortClassName }} extends Controller
{
    public function show{{ entityNameUC }}Action(int $id): Response
    {
        try {
            ${{ entityNameLC }} = $this->get{{ entityNameUC }}($id);
            $vm = $this->buildVm(${{ entityNameLC }});

            return $this->render('{{ templateName }}', ['vm' => $vm]);
        } catch ({{ exceptionShortClassName }} $nfe) {
            throw $this->createNotFoundException($id);
        }
    }

    private function get{{ entityNameUC }}(int $id): {{ useCaseResponseShortClassName }}
    {
        return $this->get('{{ useCaseServiceName }}')
            ->execute(
                $this->get('{{ useCaseRequestBuilderServiceName }}')
                    ->create()
                    ->with{{ entityNameUC }}Id($id)
                    ->build()
            );
    }

    private function buildVm({{ useCaseResponseShortClassName }} ${{ entityNameLC }}): {{ showViewModelShortClassName }}
    {
        return
            $this->get('{{ showViewModelBuilderServiceName }}')
                ->create()
                ->with{{ entityNameUC }}Detail($this->get('{{ viewModelDetailAssemblerServiceName }}')->createDetail(${{ entityNameLC}}))
                ->build();
    }
}
